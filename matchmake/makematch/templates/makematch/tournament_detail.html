{% extends "base.html" %}
{% load django_bootstrap5 %}

{% block extraheader %}
{% endblock %}

{% block main %}
<h2>{{ tournament.title }}{% comment %}  by {{ tournament.created_by.username }} {% endcomment %}</h2>

<ul class="nav nav-tabs" id="myTab" role="tablist">
  <li class="nav-item" role="presentation">
    <button
      class="nav-link"
      id="home-tab"
      data-bs-toggle="tab"
      data-bs-target="#home"
      type="button"
      role="tab"
      aria-controls="home"
      aria-selected="false"
    >
      大会詳細
    </button>
  </li>

  <li class="nav-item" role="presentation">
    <button
      class="nav-link active"
      id="contact-tab"
      data-bs-toggle="tab"
      data-bs-target="#contact"
      type="button"
      role="tab"
      aria-controls="round"
      aria-selected="true"
    >
      参加者詳細
    </button>
  </li>
  <li class="nav-item" role="presentation">
    <button
      class="nav-link"
      id="contact-tab"
      data-bs-toggle="tab"
      data-bs-target="#round"
      type="button"
      role="tab"
      aria-controls="round"
      aria-selected="false"
    >
      ラウンド詳細
    </button>
  </li>
</ul>
<div class="tab-content" id="myTabContent">
  <div
    class="tab-pane fade"
    id="home"
    role="tabpanel"
    aria-labelledby="home-tab"
  >

    <div class="card">
        <div class="card-body">
            {% comment %} <h3 class="card-title">{{ tournament.title }}</h3> {% endcomment %}
            <ul class="list-group list-group-flush">
                <li class="list-group-item">参加人数:{{tournament.player_num}}人</li>
                <li class="list-group-item">ラウンド数:{{tournament.round}}</li>
                <li class="list-group-item">作成日:{{tournament.created_at}}</li>
            </ul>
            <a href="{% url 'round_new' tournament.id %}" class="btn btn-primary">新規ラウンド作成</a>
        </div>
    </div>

  </div>
  <div
    class="tab-pane fade show active"
    id="contact"
    role="tabpanel"
    aria-labelledby="contact-tab"
  >
  <table class="table">
    <thead>
    <tr>
        <th>参加者名</th>
        <th>勝ち点</th>
        <th>OMW%</th>
        <th>勝手累点</th>
        <th>平均OMW%</th>
        <th>ドロップ</th>
    </tr>
    </thead>
    <tbody>
    {% for player in players %}
        <tr>
            <th>{{ player.name }}</th>
            <th>{{ player.points }}</th>
            <th>{{ player.omw }}</th>
            <th>{{ player.sowp }}</th>
            <th>{{ player.avr_omw }}</th>
            <th>{{ player.drop }}</th>
            <th><a href="{% url 'player_edit' player.id %}">編集</a></th>
            {% comment %} <th><a href="{% url 'tournament_detail' tournament.id %}">{{ tournament.title }}</a></th> {% endcomment %}
        </tr>

    {% endfor %}
    </tbody>
</table>

  </div>
    <div
    class="tab-pane fade"
    id="round"
    role="tabpanel"
    aria-labelledby="round-tab"
  >
{% if rounds %}
<table class="table">
    <thead>
    <tr>
        <th>Round</th>
    </tr>
    </thead>
    <tbody>
    {% for round in rounds %}
    <tr>
        <th>Round{{ round.round }}</th>
        <th><a href="{% url 'round_detail' round.id %}">編集</a></th> {% comment %} ここをラウンド詳細にする {% endcomment %}
    </tr>
    {% endfor %}
    </tbody>
</table>
{% else %}
<p>大会はまだ作成されていません</p>
{% endif %}
  </div>
</div>

{% comment %} <p>{{ snippet.description }}</p> {% endcomment %}

{% comment %} 
<div class="card">
    <div class="card-body">
        <h3 class="card-title">コメント一覧</h3>

        {% if comments %}
        {% for c in comments %}
        <hr/>
        <p class="card-text">{{ c.text }}</p>
        <small class="text-muted">by {{ c.commented_by.username }} さん {{ c.commented_at|date:"DATETIME_FORMAT" }}</small>
        {% endfor %}
        {% else %}
        <p>コメントはありません。</p>
        {% endif %}
    </div>
    {% if user.is_authenticated %}
    <div class="card-body">
        <h4 class="card-title">コメントを投稿する</h4>
        <form method="post" action="{% url 'comment_new' snippet.id %}">
            {% csrf_token %}
            {% bootstrap_form comment_form %}
            {% bootstrap_button button_type="submit" content="コメント" %}
        </form>
    </div>
    {% endif %}
</div> 
{% endcomment %}
{% endblock %}

